# 1.创建修改及删除

## 1.1 创建视图

CREATE VIEW语法：

CREATE [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
    VIEW view_name [(column_list)]
    AS select_statement
    [WITH [CASCADED | LOCAL] CHECK OPTION]
该语句能创建新的视图，如果给定了OR REPLACE子句，该语句还能替换已有的视图。select_statement是一种SELECT语句，它给出了视图的定义。该语句可从基表或其他视图进行选择。

CREATE VIEW语句要求具有针对视图的CREATE VIEW权限，以及针对由SELECT语句选择的每一列上的某些权限。对于在SELECT语句中其他地方使用的列，必须具有SELECT权限。如果还有OR REPLACE子句，必须在视图上具有DROP权限。

视图属于数据库。在默认情况下，将在当前数据库创建新视图。要想在给定数据库中明确创建视图，创建时，应将名称指定为db_name.view_name。

下面的例子中就是创建一个视图v，该视图包含从另一个表t中选择两列并用一个表达式计算这两列的数据：

mysql> CREATE DATABASE test;
mysql> USE test;
mysql> CREATE TABLE t (qty INT, price INT);
mysql> INSERT INTO t VALUES(3, 50), (5, 60);
mysql> CREATE VIEW v AS SELECT qty, price, qty*price AS value FROM t;
mysql> SELECT * FROM v;


视图定义服从下述限制：

SELECT语句不能包含FROM子句中的子查询。

SELECT语句不能引用系统或用户变量。

SELECT语句不能引用预处理语句参数。

在存储子程序内，定义不能引用子程序参数或局部变量。

在定义中引用的表或视图必须存在。但是，创建了视图后，能够舍弃定义引用的表或视图。要想检查视图定义是否存在这类问题，可使用CHECK TABLE语句。

在定义中不能引用TEMPORARY表，不能创建TEMPORARY视图。

在视图定义中命名的表必须已存在。

不能将触发程序与视图关联在一起。

在视图定义中允许使用ORDER BY，但是，如果从特定视图进行了选择，而该视图使用了具有自己ORDER BY的语句，它将被忽略。

对于定义中的其他选项或子句，它们将被增加到引用视图的语句的选项或子句中，但效果未定义。例如，如果在视图定义中包含LIMIT子句，而且从特定视图进行了选择，而该视图使用了具有自己LIMIT子句的语句，那么对使用哪个LIMIT未作定义。相同的原理也适用于其他选项，如跟在SELECT关键字后的ALL、DISTINCT或SQL_SMALL_RESULT，并适用于其他子句，如INTO、FOR UPDATE、LOCK IN SHARE MOD、以及PROCEDURE。

如果应用系统变量创建视图，并通过更改系统变量更改了查询处理环境，会影响从视图获得的结果：

mysql> CREATE VIEW v_1 AS SELECT CHARSET(''), COLLATION('');
mysql> SET NAMES 'latin1';
mysql> SELECT * FROM v_1;
mysql> SET NAMES 'utf8';
mysql> SELECT * FROM v_1;


2.1.2 修改视图

ALTER VIEW 语法

ALTER [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
    VIEW view_name [(column_list)]
    AS select_statement
    [WITH [CASCADED | LOCAL] CHECK OPTION]
该语句用于更改已有视图的定义。其语法与CREATE VIEW类似。

2.1.3 删除视图

DROP VIEW语法：

DROP VIEW [IF EXISTS]
    view_name [, view_name] ...
    [RESTRICT | CASCADE]
DROP VIEW能够删除1个或多个视图。必须在每个视图上拥有DROP权限。

可以使用关键字IF EXISTS来防止因不存在的视图而出错，给定了该子句时，将为每个不存在的视图生成NOTE。

如果给定了RESTRICT和CASCADE，将解析并忽略它们。

来源: 实验楼
链接: https://www.shiyanlou.com/courses/9
本课程内容，由作者授权实验楼发布，未经允许，禁止转载、下载及非法传播
