# 1.创建数据库
创建一个数据库`TEST`，并切换到该数据库：
```
mysql> CREATE DATABASE TEST;
Query OK, 1 row affected (0.09 sec)
```
```
mysql> USE TEST;
Database changed
```
再创建一个表:
```
mysql> CREATE TABLE shop (
    -> article INT(4) UNSIGNED ZEROFILL DEFAULT '0000' NOT NULL,
    -> dealer  CHAR(20)                 DEFAULT ''     NOT NULL,
    -> price   DOUBLE(16,2)             DEFAULT '0.00' NOT NULL,
    -> PRIMARY KEY(article, dealer));
# 插入数据
mysql> INSERT INTO shop VALUES
    -> (1,'A',3.45),(1,'B',3.99),(2,'A',10.99),(3,'B',1.45),
    -> (3,'C',1.69),(3,'D',1.25),(4,'D',19.95);
```
用`select`语句显示一下：
```
mysql> select *from shop;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0001 | A      |  3.45 |
|    0001 | B      |  3.99 |
|    0002 | A      | 10.99 |
|    0003 | B      |  1.45 |
|    0003 | C      |  1.69 |
|    0003 | D      |  1.25 |
|    0004 | D      | 19.95 |
+---------+--------+-------+
7 rows in set (0.02 sec)
```
# 2.寻找列的最大值

使用`MAX()`函数计算物品号`article`的最大值：
```
mysql> SELECT MAX(article) as article FROM shop;
+---------+
| article |
+---------+
|       4 |
+---------+
1 row in set (0.00 sec)
```
#  3.查询某列最大值所在的行
```
# 显示price这一列最大值对应的行
mysql> SELECT article,dealer,price
    -> FROM shop
    -> WHERE price = (SELECT MAX(price) FROM shop);
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0004 | D      | 19.95 |
+---------+--------+-------+
1 row in set (0.01 sec)
```
另外一个方法是对所有行进行价格的降序排序，然后使用MySQL特有的LIMIT子句显示其中一行（这里是指定第一行显示最高价格）：
```
mysql> SELECT article, dealer, price
    -> FROM shop
    -> ORDER BY price DESC
    -> LIMIT 1;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0004 | D      | 19.95 |
+---------+--------+-------+
1 row in set (0.03 sec)
```
### 注：如果有多项物品的价格都是19.95（最贵的物品不止一个），那么LIMIT的显示结果也只会显示其中一个。

# 4. 按组显示列的最大值

通过以下代码找出每项物品中对应出价最高价格
```
mysql>  SELECT article, MAX(price) AS price
    -> FROM shop
    -> GROUP BY article
    -> ;
+---------+-------+
| article | price |
+---------+-------+
|    0001 |  3.99 |
|    0002 | 10.99 |
|    0003 |  1.69 |
|    0004 | 19.95 |
+---------+-------+
4 rows in set (0.06 sec)
```
# 5.使用用户变量

通过使用用户变量找出价格最高或者最低的物品：
```
mysql> SELECT @min_price:=MIN(price),@max_price:=MAX(price) FROM shop;
+------------------------+------------------------+
| @min_price:=MIN(price) | @max_price:=MAX(price) |
+------------------------+------------------------+
|                   1.25 |                  19.95 |
+------------------------+------------------------+
1 row in set (0.02 sec)

mysql> SELECT * FROM shop WHERE price=@min_price OR price=@max_price;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0003 | D      |  1.25 |
|    0004 | D      | 19.95 |
+---------+--------+-------+
2 rows in set (0.00 sec)
```
### 思考其他的方式求出价格的最大值和最低值所对应的物品。
但是下面这样是有问题的(article,dealer都不对):
```
mysql> select article,dealer,MAX(price) price from shop;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0001 | A      | 19.95 |
+---------+--------+-------+
1 row in set (0.00 sec)

mysql> select article,dealer,MIN(price) price from shop;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0001 | A      |  1.25 |
+---------+--------+-------+
1 row in set (0.00 sec)

```
正确姿势:
```
mysql> select *from shop where(price in (select MAX(price) from shop));
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0004 | D      | 19.95 |
+---------+--------+-------+
1 row in set (0.00 sec)


mysql> select *from shop where(price in (select MIN(price) from shop));
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0003 | D      |  1.25 |
+---------+--------+-------+
1 row in set (0.00 sec)
```


